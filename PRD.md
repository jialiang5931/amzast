# 产品需求文档 (PRD) - AMZAST 亚马逊电商数据可视化平台

## 1. 文档信息
| 项目 | 内容 |
| :--- | :--- |
| **项目名称** | AMZAST (Amazon Data Analysis & Visualization Tool) |
| **版本** | v2.1 |
| **状态** | 开发中 (In Progress) |
| **最后更新** | 2026-02-13 |

## 2. 项目背景与目标
### 2.1 背景
当前亚马逊电商公司内部人员在进行文档数据分析时，缺乏统一、高效的可视化工具。处理 Excel/CSV 数据通常依赖手动操作，效率低下且难以直观发现数据趋势。同时，多数据源的整合（产品信息、关键词分析、历史销量）需要手动合并，耗时且易出错。

### 2.2 目标
构建一个 **纯前端 Web 数据可视化应用**，旨在：
- **安全高效**：数据完全在本地浏览器端处理，不上传至服务器，确保数据隐私。
- **自动化分析**：用户拖拽上传规范化 Excel 数据后，毫秒级解析并生成报表。
- **智能合并**：支持多文件自动识别与横向合并（产品表 + 关键词表 + 销量表）。
- **高端体验**：提供深色模式、流畅动画和交互式图表的现代化体验。
- **极致性能**：通过按需渲染和数据隔离，确保在处理万级数据时依然流畅。

## 3. 用户角色与流程
### 3.1 目标用户
- **主要用户**：运营人员、产品开发、数据分析师。
- **特征**：关注销量趋势、竞品分析、定价策略、关键词效果、历史数据追踪。

### 3.2 核心流程
1. **进入首页**：看到功能矩阵卡片（我的项目、市场分析、搜索列表生成等）。
2. **选择功能**：
   - **市场分析**：上传单个产品数据文件，查看可视化图表。
   - **搜索列表生成**：上传多个文件（产品表 + 关键词表 + 销量表），自动合并生成综合分析表。
3. **上传校验**：拖拽上传本地 Excel (`.xlsx`) 文件，系统自动识别文件类型并校验关键字段。
4. **展示交互**：解析数据后，通过侧边栏快速切换不同分析维度，或在表格中查看详细数据及其变化趋势。
5. **导出数据**：支持导出带嵌入图片的 Excel 文件，保留完整产品信息。

## 4. 功能需求
### 4.1 数据输入
#### 4.1.1 支持格式
- **主格式**：`.xlsx` (Excel Workbook)
- **文件类型识别**：
  - **主产品表**：`Product-{国家}-{日期}.xlsx`（如 `Product-US-20260206.xlsx`）
  - **关键词分析表**：`关键词分析_*.xlsx`
  - **销量数据表**：`product-{国家}-sales-{日期}-{编号}.xlsx`（支持多个）

#### 4.1.2 核心字段
- **基础信息**：ASIN, 品牌, 价格, 上架时间, SKU, 商品标题, 商品主图
- **关键指标**：**父体销量**（原月销量）, 子体销量, 评分, 评分数, 自然排名
- **历史数据**（用于趋势绘图，前端默认隐藏）：
  - 历史月销量（父体/子体）
  - 历史月销售额（父体/子体）
  - 历史月价格

### 4.2 搜索列表生成器 (Search List Generator)
#### 4.2.1 功能概述
智能合并多个数据源，生成统一的产品分析列表，并提供即时的趋势查看功能。

#### 4.2.2 数据处理逻辑
1. **字段规范化 (Normalization)**：
   - 自动映射同义字段（如：`月销量` -> `父体销量`）。
   - 自动清洗冗长字段名（如：`自然排名(页码-页内排名)` -> `自然排名`）。
   
2. **多源合并 (Left Join)**：
   - 以 ASIN 为主键，支持产品、关键词、历史销量的高效合并。
   - 提取日期模式 `YYYY-MM` 后缀，支持动态月份追踪。

#### 4.2.3 表格展示优化
1. **高性能渲染 (Performance Guard)**：
   - **数据隔离**：网页前台**隐藏**所有 `YYYY-MM-*` 格式的历史列。这极大减少了 DOM 节点数量，提升了数倍的渲染和搜索速度。
   - **后台持有**：隐藏列的数据依然保留在内存中，供悬浮框图表提取使用。
   
2. **交互式趋势 (Hover Charts)**：
   - **价格趋势**：鼠标移动到“价格”单元格，弹出价格历史折线图。
   - **销量趋势**：鼠标移动到“父体销量”或“子体销量”单元格，弹出对应的对比折线图（支持近 3 年对比）。
   
3. **UI 增强**：
   - **居中对齐**：主图列、ASIN列、排名等关键数值列采用居中对齐，提升视觉平衡感。
   - **主图放大**：支持 150% 缩放放大，配合 GPU 加速。
   - **双滚动条**：表格上下均有横向滚动条，同步滚动。
   - **面板联动**：支持一键收起/展开搜索操作面板，增加表格可视区域。

#### 4.2.4 导出功能
- **全量导出**：虽然前台隐藏了历史列，但导出 Excel 时将包含**全量原始数据**。
- **图片嵌入**：使用 `exceljs` 在 Excel 中嵌入 100x100px 的产品主图，方便线下传阅。

## 5. 核心图表设计 (Visuals)
1. **父体/子体销量趋势**：
   - 基于 `YYYY-MM-*-U` 字段绘制。
   - 实现**近三年同期对比**，帮助识别季节性波动。
2. **价格历史记录**：
   - 基于 `YYYY-MM-子-P` 字段绘制。
   - 展示价格随时间的变化轨迹。

## 6. 技术架构与非功能需求
- **架构**：React 19 + TypeScript + Vite。
- **UI**：Lucide 图标库 + Tailwind CSS (毛玻璃、微动效)。
- **性能**：
  - 加载：100行数据渲染不超过 100ms。
  - 导出：带图片导出支持容错机制。
- **安全**：100% 纯本地运行，标签页标题显示为 `AMZAST`。

## 7. 后续规划
- [x] 表格列排序功能（点击表头排序）
- [x] 自定义列显示/隐藏（已通过历史列自动隐藏实现优化）
- [ ] 批量导出 PDF 详细报告
- [ ] 数据可视化看板（Dashboard）全局筛选器
- [ ] 针对 FBA 费用的利润计算器模拟
- [ ] 关键词排名变化追踪分析模块
