# 产品需求文档 (PRD) - AMZAST 亚马逊电商数据可视化平台

## 1. 文档信息
| 项目 | 内容 |
| :--- | :--- |
| **项目名称** | AMZAST (Amazon Data Analysis & Visualization Tool) |
| **版本** | v2.2 |
| **状态** | 开发中 (In Progress) |
| **最后更新** | 2026-02-17 |

## 2. 项目背景与目标
### 2.1 背景
当前亚马逊电商公司内部人员在进行文档数据分析时，缺乏统一、高效的可视化工具。处理 Excel/CSV 数据通常依赖手动操作，效率低下且难以直观发现数据趋势。同时，多数据源的整合（产品信息、关键词分析、历史销量）需要手动合并，耗时且易出错。

### 2.2 目标
构建一个 **纯前端 Web 数据可视化应用**，旨在：
- **安全高效**：数据完全在本地浏览器端处理，不上传至服务器，确保数据隐私。
- **自动化分析**：用户拖拽上传规范化 Excel 数据后，毫秒级解析并生成报表。
- **智能合并**：支持多文件自动识别与横向合并（产品表 + 关键词表 + 销量表）。
- **高端体验**：提供深色模式、流畅动画和交互式图表的现代化体验。
- **极致性能**：通过按需渲染和数据隔离，确保在处理万级数据时依然流畅。

## 3. 用户角色与流程
### 3.1 目标用户
- **主要用户**：运营人员、产品开发、数据分析师。
- **特征**：关注销量趋势、竞品分析、定价策略、关键词效果、历史数据追踪。

### 3.2 核心流程
1. **进入首页**：看到功能矩阵卡片（我的项目、市场分析、搜索列表生成等）。
2. **选择功能**：
   - **市场分析**：上传单个产品数据文件，查看可视化图表。
   - **搜索列表生成**：上传多个文件（产品表 + 关键词表 + 销量表），自动合并生成综合分析表。
3. **上传校验**：拖拽上传本地 Excel (`.xlsx`) 文件，系统自动识别文件类型并提取站点信息（如 US, JP）。
4. **展示交互**：解析数据后，通过侧边栏快速切换不同分析维度，或在表格中查看详细数据及其变化趋势。
5. **一键分析**：在搜索列表预览页直接点击“生成市场分析”，将清洗后的全量数据一键导入可视化看板。
6. **导出数据**：支持导出带嵌入图片的 Excel 文件，包含增强的超链接和导出专用字段。

## 4. 功能需求
### 4.1 数据输入
#### 4.1.1 支持格式
- **主格式**：`.xlsx` (Excel Workbook)
- **文件类型及站点识别**：
  - **主产品表**：`Product-{站点}-{日期}.xlsx`。系统自动识别站点码（如 US, UK, JP, DE 等）。
  - **关键词分析表**：`关键词分析_*.xlsx`
  - **销量数据表**：自动识别 `产品历史月销量`、`子体历史月销量` 等工作簿。

#### 4.1.2 核心字段
- **基础信息**：ASIN, 品牌, 价格, 上架时间, SKU, 商品标题, 商品主图
- **关键指标**：**父体销量**（原月销量）, 子体销量, 评分, 评分数, 自然排名
- **历史数据**（用于趋势绘图，前端默认隐藏）：
  - 历史月销量（父体/子体）
  - 历史月销售额（父体/子体）
  - 历史月价格
- **派生字段**：
  - **自然:广告**：根据流量分布自动计算比例。
  - **上架时段**：根据上架时间自动归类（3个月、6个月等）。
  - **配送方式**：支持 FBM 逻辑，若配送方式为 FBM，则 FBA 费用列显示为 "FBM"。

### 4.2 搜索列表生成器 (Search List Generator)
#### 4.2.1 功能概述
智能合并多个数据源，生成统一的产品分析列表，提供深度链接和即时趋势预览。

#### 4.2.2 数据处理逻辑
1. **字段规范化 (Normalization)**：
   - 自动映射同义字段（如：`月销量` -> `父体销量`）。
   - 自动清洗冗长字段名（如：`自然排名(页码-页内排名)` -> `自然排名`）。
   
2. **多源合并 (Left Join)**：
   - 以 ASIN 为主键，支持产品、关键词、历史销量的高效合并。

#### 4.2.3 深度链接 (Hyperlinks)
系统在 UI 表格和导出 Excel 中均实现了以下超链接：
1. **ASIN**：跳转至亚马逊商品详情页。
2. **品牌**：跳转至品牌旗舰店/搜索页。
3. **BuyBox卖家**：跳转至卖家首页。
4. **自然排名**：智能拼写跳转至西柚找词（xiyouzhaoci.com）详情页，格式：`.../look_up/{site}/{asin}`。

#### 4.2.4 表格展示优化
1. **高性能渲染 (Performance Guard)**：
   - **数据隔离**：网页前台**隐藏**所有 `YYYY-MM-*` 格式的历史列。这极大减少了 DOM 节点数量，提升了数倍的渲染和搜索速度。
   - **后台持有**：隐藏列的数据依然保留在内存中，供悬浮框图表提取使用。
   
2. **交互式趋势 (Hover Charts)**：
   - **价格趋势**：鼠标移动到“价格”单元格，弹出价格历史折线图。
   - **销量趋势**：鼠标移动到“父体销量”或“子体销量”单元格，弹出对应的对比折线图（支持近 3 年对比）。
   
3. **UI 增强**：
   - **居中对齐**：主图列、ASIN列、排名等关键数值列采用居中对齐，提升视觉平衡感。
   - **主图放大**：支持 150% 缩放放大，配合 GPU 加速。
   - **双滚动条**：表格上下均有横向滚动条，同步滚动。
   - **面板联动**：支持一键收起/展开搜索操作面板，增加表格可视区域。

#### 4.2.4 导出功能增强
1. **导出专用列**：在导出 Excel 时，自动在“父ASIN”列后插入 **“商品标题”**、**“Coupon”** 和 **“商品主图”** 三列。这些列在 UI 中隐藏以保持简洁。
2. **动态列宽**：根据表头文字长度自动计算最佳列宽，支持中文字符识别。
3. **历史数据排序**：历史列按照后缀（-父-U, -子-U 等）分组，并按日期倒序排列。
4. **统一样式**：导出文件中的所有超链接均为黑色字体加下划线，保持专业观感。
5. **图片嵌入**：使用 `exceljs` 在 Excel 中嵌入 100x100px 的产品主图，方便线下传阅。

### 4.3 衔接功能：搜索列表 -> 市场分析
1. **一键生成**：搜索列表预览页新增“生成市场分析”按钮。
2. **数据流转**：点击后，全量合并后的数据将跳过文件二次上传，直接进入市场分析模块。
3. **兼容性**：支持用户将下载后的搜索列表重新上传至市场分析页面进行解析。

## 5. 核心图表设计 (Visuals)
1. **父体/子体销量趋势**：
   - 基于 `YYYY-MM-*-U` 字段绘制。
   - 实现**近三年同期对比**，帮助识别季节性波动。
2. **价格历史记录**：
   - 基于 `YYYY-MM-子-P` 字段绘制。
   - 展示价格随时间的变化轨迹。

## 6. 技术架构与非功能需求
- **架构**：React 19 + TypeScript + Vite。
- **UI**：Lucide 图标库 + Tailwind CSS (毛玻璃、微动效)。
- **性能**：
  - 加载：100行数据渲染不超过 100ms。
  - 导出：带图片导出支持容错机制。
- **安全**：100% 纯本地运行，标签页标题显示为 `AMZAST`。

## 7. 后续规划
- [x] 自动提取站点信息 (Site Extraction)
- [x] 自然排名超链接 (Natural Ranking Link)
- [x] 导出增强 (标题/Coupon/主图 插入)
- [x] FBM 配送方式显示逻辑
- [ ] 搜索列表与市场分析一键衔接 (In Progress)
- [ ] 关键词排名变化追踪分析模块
